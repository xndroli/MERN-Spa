(this["webpackJsonpmern-client"]=this["webpackJsonpmern-client"]||[]).push([[0],{78:function(t,e,c){},80:function(t,e,c){},84:function(t,e,c){},85:function(t,e,c){"use strict";c.r(e);var n=c(1),a=c.n(n),r=c(63),s=c.n(r),i=(c(78),c(5)),o=c(13),j=c(6),l=c(67),d=c(96),u=c(98),b=c(95),O=c(65),h=c(12),p=c(8);function m(t,e){return 1===e?t:t+"s"}function x(t,e,c){return new Promise((function(n,a){var r,s,i,o=window.indexedDB.open("shop-shop",1);o.onupgradeneeded=function(t){var e=o.result;e.createObjectStore("products",{keyPath:"_id"}),e.createObjectStore("services",{keyPath:"_id"}),e.createObjectStore("categories",{keyPath:"_id"}),e.createObjectStore("cart",{keyPath:"_id"})},o.onerror=function(t){console.log("There was an error")},o.onsuccess=function(a){switch(r=o.result,s=r.transaction(t,"readwrite"),i=s.objectStore(t),r.onerror=function(t){console.log("error",t)},e){case"put":i.put(c),n(c);break;case"get":var j=i.getAll();j.onsuccess=function(){n(j.result)};break;case"delete":i.delete(c._id);break;default:console.log("No valid method")}s.oncomplete=function(){r.close()}}}))}var f=c(0);var v=function(){var t=Object(n.useState)({name:"",email:"",message:""}),e=Object(p.a)(t,2),c=e[0],a=e[1],r=Object(n.useState)(""),s=Object(p.a)(r,2),o=s[0],j=s[1],l=c.name,d=c.email,u=c.message,b=function(t){if("email"===t.target.name){var e=function(t){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(t).toLowerCase())}(t.target.value);j(e?"":"Your email is invalid.")}else t.target.value.length?j(""):j("".concat(t.target.name," is required."));o||(a(Object(i.a)(Object(i.a)({},c),{},Object(h.a)({},t.target.name,t.target.value))),console.log("Handle Form",c))};return Object(f.jsxs)("section",{className:"form",children:[Object(f.jsx)("h1",{"data-testid":"h1tag",children:"Contact me"}),Object(f.jsxs)("form",{id:"contact-form",onSubmit:function(t){t.preventDefault(),o||console.log("Submit Form",c)},children:[Object(f.jsxs)("div",{children:[Object(f.jsx)("label",{className:"text-label",htmlFor:"name",children:"Name:"}),Object(f.jsx)("input",{className:"text-input",type:"text",name:"name",defaultValue:l,onBlur:b})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("label",{className:"text-label",htmlFor:"email",children:"Email address:"}),Object(f.jsx)("input",{className:"text-input",type:"email",name:"email",defaultValue:d,onBlur:b})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("label",{className:"text-label",htmlFor:"message",children:"Message:"}),Object(f.jsx)("textarea",{className:"text-input",name:"message",rows:"5",defaultValue:u,onBlur:b})]}),o&&Object(f.jsx)("div",{children:Object(f.jsx)("p",{className:"error-text",children:o})}),Object(f.jsx)("button",{"data-testid":"button",type:"submit",children:"Submit"})]})]})};c(80);var g=function(t){var e=t.children;return Object(f.jsxs)("div",{className:"jumbotron",children:[Object(f.jsxs)("div",{className:"jumbotron-cta",children:[e,Object(f.jsx)("h2",{children:"Welcome to the MERN Spa!"}),Object(f.jsx)("p",{children:"Have a look around to see what we're about"})]}),Object(f.jsx)("div",{className:"jumbotron-form",children:Object(f.jsx)(v,{})})]})},y=function(){return Object(f.jsxs)("main",{children:[Object(f.jsx)("div",{className:"jumbotron",children:Object(f.jsx)(g,{})}),Object(f.jsxs)("div",{className:"intro",children:[Object(f.jsx)("h2",{className:"section-title",children:"Our Philosophy"}),Object(f.jsx)("p",{children:"Search through our products and services to learn about the different aspects of the MERN stack."})]})]})},w=c(68),_=c(16),N="UPDATE_PRODUCTS",k="UPDATE_SERVICES",S="ADD_TO_CART",C="ADD_MULTIPLE_TO_CART",E="REMOVE_FROM_CART",Q="UPDATE_CART_QUANTITY",T="TOGGLE_CART",$="UPDATE_CATEGORIES",I="UPDATE_CURRENT_CATEGORY",A=function(t){return{state:t}},D=function(t,e){switch(e.type){case N:return Object(i.a)(Object(i.a)({},t),{},{products:Object(_.a)(e.products)});case k:return console.log("action",e),Object(i.a)(Object(i.a)({},t),{},{services:Object(_.a)(e.services)});case S:return Object(i.a)(Object(i.a)({},t),{},{cartOpen:!0,cart:[].concat(Object(_.a)(t.cart),[e.product,e.services])});case C:return Object(i.a)(Object(i.a)({},t),{},{cart:[].concat(Object(_.a)(e.products),Object(_.a)(e.services))});case Q:return Object(i.a)(Object(i.a)({},t),{},{cartOpen:!0,cart:t.cart.map((function(t){return e._id===t._id&&(t.purchaseQuantity=e.purchaseQuantity),t}),(function(t){return e._id===t._id&&(t.purchaseQuantity=e.purchaseQuantity),t}))});case E:var c=t.cart.filter((function(t){return t._id!==e._id}),(function(t){return t._id!==e._id}));return Object(i.a)(Object(i.a)({},t),{},{cartOpen:c.length>0,cart:c});case"CLEAR_CART":return Object(i.a)(Object(i.a)({},t),{},{cartOpen:!1,cart:[]});case T:return Object(i.a)(Object(i.a)({},t),{},{cartOpen:!t.cartOpen});case $:return Object(i.a)(Object(i.a)({},t),{},{categories:Object(_.a)(e.categories)});case I:return Object(i.a)(Object(i.a)({},t),{},{currentCategory:e.currentCategory});default:return A(t)}};var P=["value"],R=Object(n.createContext)(),q=R.Provider,F=function(t){t.value;var e,c=Object(w.a)(t,P),a=(e={products:[],services:[],cart:[],cartOpen:!1,categories:[],currentCategory:""},Object(n.useReducer)(D,e,A)),r=Object(p.a)(a,2),s=r[0],o=r[1];return Object(f.jsx)(q,Object(i.a)({value:[s,o]},c))},U=function(){return Object(n.useContext)(R)};var L,B,W,M,Y,G,H,V=function(t){var e=U(),c=Object(p.a)(e,2),n=c[0],a=c[1],r=t.image,s=t.name,j=t._id,l=t.price,d=t.quantity,u=n.cart;return Object(f.jsxs)("div",{className:"card px-1 py-1",children:[Object(f.jsxs)(o.b,{to:"/products/".concat(j),children:[Object(f.jsx)("img",{alt:s,src:"/images/".concat(r)}),Object(f.jsx)("p",{children:s})]}),Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{children:[d," ",m("item",d)," in stock"]}),Object(f.jsxs)("span",{children:["$",l]})]}),Object(f.jsx)("button",{onClick:function(){var e=u.find((function(t){return t._id===j}));e?(a({type:Q,_id:j,purchaseQuantity:parseInt(e.purchaseQuantity)+1}),x("cart","put",Object(i.a)(Object(i.a)({},e),{},{purchaseQuantity:parseInt(e.purchaseQuantity)+1}))):(a({type:S,product:Object(i.a)(Object(i.a)({},t),{},{purchaseQuantity:1})}),x("cart","put",Object(i.a)(Object(i.a)({},t),{},{purchaseQuantity:1})))},children:"Add to cart"})]})},z=c(69),J=c(22),Z=c(97),K=Object(Z.a)(L||(L=Object(J.a)(["\n\tquery getProducts($category: ID) {\n\t\tproducts(category: $category) {\n\t\t\t_id\n\t\t\tname\n\t\t\tdescription\n\t\t\tprice\n\t\t\tquantity\n\t\t\timage\n\t\t\tcategory {\n\t\t\t\t_id\n\t\t\t}\n\t\t}\n\t}\n"]))),X=Object(Z.a)(B||(B=Object(J.a)(["\n\tquery getServices($category: ID) {\n\t\tservices(category: $category) {\n\t\t\t_id\n\t\t\tname\n\t\t\tdescription\n\t\t\tprice\n\t\t\tquantity\n\t\t\timage\n\t\t\tcategory {\n\t\t\t\t_id\n\t\t\t}\n\t\t}\n\t}\n"]))),tt=Object(Z.a)(W||(W=Object(J.a)(["\n\tquery getCheckout($products: [ID]!, $services: [ID]!) {\n\t\tcheckout(products: $products, services: $services) {\n\t\t\tsession\n\t\t}\n\t}\n"]))),et=(Object(Z.a)(M||(M=Object(J.a)(["\n\t{\n\t\tproducts {\n\t\t\t_id\n\t\t\tname\n\t\t\tdescription\n\t\t\tprice\n\t\t\tquantity\n\t\t\tcategory {\n\t\t\t\tname\n\t\t\t}\n\t\t}\n\t}\n"]))),Object(Z.a)(Y||(Y=Object(J.a)(["\n\t{\n\t\tservices {\n\t\t\t_id\n\t\t\tname\n\t\t\tdescription\n\t\t\tprice\n\t\t\tquantity\n\t\t\tcategory {\n\t\t\t\tname\n\t\t\t}\n\t\t}\n\t}\n"]))),Object(Z.a)(G||(G=Object(J.a)(["\n\t{\n\t\tcategories {\n\t\t\t_id\n\t\t\tname\n\t\t}\n\t}\n"]))),Object(Z.a)(H||(H=Object(J.a)(["\n\t{\n\t\tuser {\n\t\t\tfirstName\n\t\t\tusername\n\t\t\torders {\n\t\t\t\t_id\n\t\t\t\tpurchaseDate\n\t\t\t\tproducts {\n\t\t\t\t\t_id\n\t\t\t\t\tname\n\t\t\t\t\tdescription\n\t\t\t\t\tprice\n\t\t\t\t\tquantity\n\t\t\t\t\timage\n\t\t\t\t}\n\t\t\t\tservices {\n\t\t\t\t\t_id\n\t\t\t\t\tname\n\t\t\t\t\tdescription\n\t\t\t\t\tprice\n\t\t\t\t\tquantity\n\t\t\t\t\timage\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"])))),ct=c.p+"static/media/spinner.689d9a07.gif";var nt=function(){var t=U(),e=Object(p.a)(t,2),c=e[0],a=e[1],r=c.currentCategory,s=Object(z.b)(K),i=s.loading,o=s.data;return Object(n.useEffect)((function(){o?(a({type:N,products:o.products}),o.products.forEach((function(t){x("products","put",t)}))):i||x("products","get").then((function(t){a({type:N,products:t})}))}),[o,i,a]),Object(f.jsxs)("div",{className:"my-2 container",children:[Object(f.jsx)("h2",{children:"Our Products:"}),c.products?Object(f.jsx)("div",{className:"flex-row",children:(r?c.products.filter((function(t){return t.category._id===r})):c.products).map((function(t){return Object(f.jsx)(V,{_id:t._id,image:t.image,name:t.name,price:t.price,quantity:t.quantity},t._id)}))}):Object(f.jsx)("h3",{children:"You haven't added any products yet!"}),i?Object(f.jsx)("img",{src:ct,alt:"loading"}):null]})};var at=c(9),rt=c(14),st=c(64),it=c(92),ot=function(t){var e=t.item,c=U(),n=Object(p.a)(c,2)[1];return Object(f.jsxs)("div",{className:"flex-row",children:[Object(f.jsx)("div",{children:Object(f.jsx)("img",{src:"/images/".concat(e.image),alt:""})}),Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{children:[e.name,", $",e.price]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{children:"Qty:"}),Object(f.jsx)("input",{type:"number",placeholder:"1",value:e.purchaseQuantity,onChange:function(t){var c=t.target.value;"0"===c?(n({type:E,_id:e._id}),x("cart","delete",Object(i.a)({},e))):(n({type:Q,_id:e._id,purchaseQuantity:parseInt(c)}),x("cart","put",Object(i.a)(Object(i.a)({},e),{},{purchaseQuantity:parseInt(c)})))}}),Object(f.jsx)("span",{role:"img","aria-label":"trash",onClick:function(){return function(t){n({type:E,_id:t._id}),x("cart","delete",Object(i.a)({},t))}(e)},children:"\ud83d\uddd1\ufe0f"})]})]})]})},jt=c(28),lt=c(27),dt=c(54),ut=c.n(dt),bt=new(function(){function t(){Object(jt.a)(this,t)}return Object(lt.a)(t,[{key:"getProfile",value:function(){return ut()(this.getToken())}},{key:"loggedIn",value:function(){var t=this.getToken();return!!t&&!this.isTokenExpired(t)}},{key:"isTokenExpired",value:function(t){try{return ut()(t).exp<Date.now()/1e3}catch(e){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(t){localStorage.setItem("id_token",t),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),t}()),Ot=(c(84),Object(st.a)("pk_test_TYooMQauvdEDq54NiTphI7jx")),ht=function(){var t=U(),e=Object(p.a)(t,2),c=e[0],a=e[1],r=Object(it.a)(tt),s=Object(p.a)(r,2),i=s[0],o=s[1].data;function j(){a({type:T})}return Object(n.useEffect)((function(){o&&Ot.then((function(t){t.redirectToCheckout({sessionId:o.checkout.session})}))}),[o]),Object(n.useEffect)((function(){function t(){return(t=Object(rt.a)(Object(at.a)().mark((function t(){var e;return Object(at.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x("cart","get");case 2:e=t.sent,a({type:C,products:Object(_.a)(e),services:Object(_.a)(e)});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}console.log("inside cart useEffect"),c.cart||function(){t.apply(this,arguments)}()}),[c.cart,a]),c.cartOpen?(console.log("state cart",c.cart),Object(f.jsxs)("div",{className:"cart",children:[Object(f.jsx)("div",{className:"close",onClick:j,children:"[close]"}),Object(f.jsx)("h2",{children:"Shopping Cart"}),c.cart?Object(f.jsxs)("div",{children:[c.cart.map((function(t){return Object(f.jsx)(ot,{item:t},t._id)})),Object(f.jsxs)("div",{className:"flex-row space-between",children:[Object(f.jsxs)("strong",{children:["Total: $",function(){var t=0;return c.cart.forEach((function(e){t+=e.price*e.purchaseQuantity})),t.toFixed(2)}()]}),bt.loggedIn()?Object(f.jsx)("button",{onClick:function(){var t=[];c.cart.forEach((function(e){for(var c=0;c<e.purchaseQuantity;c++)t.push(e._id)})),i({variables:{products:t}})},children:"Checkout"}):Object(f.jsx)("span",{children:"(log in to check out)"})]})]}):Object(f.jsxs)("h3",{children:[Object(f.jsx)("span",{role:"img","aria-label":"shocked",children:"\ud83d\ude31"}),"You haven't added anything to your cart yet!"]})]})):Object(f.jsx)("div",{className:"cart-closed",onClick:j,children:Object(f.jsx)("span",{role:"img","aria-label":"trash",children:"\ud83d\uded2"})})},pt=function(){return Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)(nt,{}),Object(f.jsx)(ht,{})]})};var mt=function(){var t=U(),e=Object(p.a)(t,2),c=e[0],a=e[1],r=Object(j.n)().id,s=Object(n.useState)({}),l=Object(p.a)(s,2),d=l[0],u=l[1],b=Object(z.b)(K),O=b.loading,h=b.data,m=c.products,v=c.cart;return Object(n.useEffect)((function(){m.length?u(m.find((function(t){return t._id===r}))):h?(a({type:N,products:h.products}),h.products.forEach((function(t){x("products","put",t)}))):O||x("products","get").then((function(t){a({type:N,products:t})}))}),[m,h,O,a,r]),Object(f.jsxs)(f.Fragment,{children:[d&&v?Object(f.jsxs)("div",{className:"container my-1",children:[Object(f.jsx)(o.b,{to:"/",children:"\u2190 Back to Products"}),Object(f.jsx)("h2",{children:d.name}),Object(f.jsx)("p",{children:d.description}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"Price:"}),"$",d.price," ",Object(f.jsx)("button",{onClick:function(){var t=v.find((function(t){return t._id===r}));t?(a({type:Q,_id:r,purchaseQuantity:parseInt(t.purchaseQuantity)+1}),x("cart","put",Object(i.a)(Object(i.a)({},t),{},{purchaseQuantity:parseInt(t.purchaseQuantity)+1}))):(a({type:S,product:Object(i.a)(Object(i.a)({},d),{},{purchaseQuantity:1})}),x("cart","put",Object(i.a)(Object(i.a)({},d),{},{purchaseQuantity:1})))},children:"Add to Cart"}),Object(f.jsx)("button",{disabled:!v.find((function(t){return t._id===d._id})),onClick:function(){a({type:E,_id:d._id}),x("cart","delete",Object(i.a)({},d))},children:"Remove from Cart"})]}),Object(f.jsx)("img",{src:"/images/".concat(d.image),alt:d.name})]}):null,O?Object(f.jsx)("img",{src:ct,alt:"loading"}):null,Object(f.jsx)(ht,{})]})};var xt=function(t){var e=U(),c=Object(p.a)(e,2),n=c[0],a=c[1],r=t.image,s=t.name,j=t._id,l=t.price,d=t.quantity,u=n.cart;return Object(f.jsxs)("div",{className:"card px-1 py-1",children:[Object(f.jsxs)(o.b,{to:"/services/".concat(j),children:[Object(f.jsx)("img",{alt:s,src:"/images/".concat(r)}),Object(f.jsx)("p",{children:s})]}),Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{children:[d," ",m("item",d)," in stock"]}),Object(f.jsxs)("span",{children:["$",l]})]}),Object(f.jsx)("button",{onClick:function(){var e=u.find((function(t){return t._id===j}));e?(a({type:Q,_id:j,purchaseQuantity:parseInt(e.purchaseQuantity)+1}),x("cart","put",Object(i.a)(Object(i.a)({},e),{},{purchaseQuantity:parseInt(e.purchaseQuantity)+1}))):(a({type:S,service:Object(i.a)(Object(i.a)({},t),{},{purchaseQuantity:1})}),x("cart","put",Object(i.a)(Object(i.a)({},t),{},{purchaseQuantity:1})))},children:"Add to cart"})]})};var ft=function(){var t=U(),e=Object(p.a)(t,2),c=e[0],a=e[1],r=c.currentCategory,s=Object(z.b)(X),i=s.loading,o=s.data;return Object(n.useEffect)((function(){o?(console.log("data is here",o),a({type:k,services:o.services}),o.services.forEach((function(t){x("services","put",t)}))):i||(console.log("data",o),x("services","get").then((function(t){a({type:k,services:t})})))}),[o,i,a]),Object(f.jsxs)("div",{className:"my-2",children:[Object(f.jsx)("h2",{children:"Our services:"}),c.services?Object(f.jsx)("div",{className:"flex-row",children:(r?c.services.filter((function(t){return t.category._id===r})):c.services).map((function(t){return Object(f.jsx)(xt,{_id:t._id,image:t.image,name:t.name,price:t.price,quantity:t.quantity},t._id)}))}):Object(f.jsx)("h3",{children:"You haven't added any services yet!"}),i?Object(f.jsx)("img",{src:ct,alt:"loading"}):null]})},vt=function(){return Object(f.jsxs)("div",{className:"container",children:[Object(f.jsx)(ft,{}),Object(f.jsx)(ht,{})]})};var gt,yt,wt,_t=function(){var t=U(),e=Object(p.a)(t,2),c=e[0],a=e[1],r=Object(j.n)().id,s=Object(n.useState)({}),l=Object(p.a)(s,2),d=l[0],u=l[1],b=Object(z.b)(X),O=b.loading,h=b.data,m=c.services,v=c.cart;return Object(n.useEffect)((function(){m.length?u(m.find((function(t){return t._id===r}))):h?(a({type:k,services:h.services}),h.services.forEach((function(t){x("services","put",t)}))):O||x("services","get").then((function(t){a({type:k,services:t})}))}),[m,h,O,a,r]),Object(f.jsxs)(f.Fragment,{children:[d&&v?Object(f.jsxs)("div",{className:"container my-1",children:[Object(f.jsx)(o.b,{to:"/",children:"\u2190 Back to Services"}),Object(f.jsx)("h2",{children:d.name}),Object(f.jsx)("p",{children:d.description}),Object(f.jsxs)("p",{children:[Object(f.jsx)("strong",{children:"Price:"}),"$",d.price," ",Object(f.jsx)("button",{onClick:function(){var t=v.find((function(t){return t._id===r}));t?(a({type:Q,_id:r,purchaseQuantity:parseInt(t.purchaseQuantity)+1}),x("cart","put",Object(i.a)(Object(i.a)({},t),{},{purchaseQuantity:parseInt(t.purchaseQuantity)+1}))):(a({type:S,service:Object(i.a)(Object(i.a)({},d),{},{purchaseQuantity:1})}),x("cart","put",Object(i.a)(Object(i.a)({},d),{},{purchaseQuantity:1})))},children:"Add to Cart"}),Object(f.jsx)("button",{disabled:!v.find((function(t){return t._id===d._id})),onClick:function(){a({type:E,_id:d._id}),x("cart","delete",Object(i.a)({},d))},children:"Remove from Cart"})]}),Object(f.jsx)("img",{src:"/images/".concat(d.image),alt:d.name})]}):null,O?Object(f.jsx)("img",{src:ct,alt:"loading"}):null,Object(f.jsx)(ht,{})]})},Nt=function(){return Object(f.jsx)("div",{children:Object(f.jsxs)(g,{children:[Object(f.jsx)("h1",{children:"404 Page Not Found"}),Object(f.jsx)("h1",{children:Object(f.jsx)("span",{role:"img","aria-label":"Face With Rolling Eyes Emoji",children:"\ud83d\ude44"})})]})})},kt=c(93),St=Object(Z.a)(gt||(gt=Object(J.a)(["\n\tmutation login($email: String!, $password: String!) {\n\t\tlogin(email: $email, password: $password) {\n\t\t\ttoken\n\t\t\tuser {\n\t\t\t\t_id\n\t\t\t}\n\t\t}\n\t}\n"]))),Ct=Object(Z.a)(yt||(yt=Object(J.a)(["\n\tmutation addOrder($products: [ID]!, $services: [ID]!) {\n\t\taddOrder(products: $products, services: $services) {\n\t\t\tpurchaseDate\n\t\t\tproducts {\n\t\t\t\t_id\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tprice\n\t\t\t\tquantity\n\t\t\t\tcategory {\n\t\t\t\t\tname\n\t\t\t\t}\n\t\t\t}\n\t\t\tservices {\n\t\t\t\t_id\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tprice\n\t\t\t\tquantity\n\t\t\t\tcategory {\n\t\t\t\t\tname\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n"]))),Et=Object(Z.a)(wt||(wt=Object(J.a)(["\n\tmutation addUser(\n\t\t$firstName: String!\n\t\t$username: String!\n\t\t$email: String!\n\t\t$password: String!\n\t) {\n\t\taddUser(\n\t\t\tfirstName: $firstName\n\t\t\tusername: $username\n\t\t\temail: $email\n\t\t\tpassword: $password\n\t\t) {\n\t\t\ttoken\n\t\t\tuser {\n\t\t\t\t_id\n\t\t\t}\n\t\t}\n\t}\n"])));var Qt=function(t){var e=Object(n.useState)({email:"",password:""}),c=Object(p.a)(e,2),a=c[0],r=c[1],s=Object(kt.a)(St),j=Object(p.a)(s,2),l=j[0],d=j[1].error,u=function(){var t=Object(rt.a)(Object(at.a)().mark((function t(e){var c,n;return Object(at.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.prev=1,t.next=4,l({variables:{email:a.email,password:a.password}});case 4:c=t.sent,n=c.data.login.token,bt.login(n),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}(),b=function(t){var e=t.target,c=e.name,n=e.value;r(Object(i.a)(Object(i.a)({},a),{},Object(h.a)({},c,n)))};return Object(f.jsxs)("div",{className:"container my-1",children:[Object(f.jsx)(o.b,{to:"/signup",children:"\u2190 Go to Signup"}),Object(f.jsx)("h2",{children:"Login"}),Object(f.jsxs)("form",{onSubmit:u,children:[Object(f.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(f.jsx)("label",{htmlFor:"email",children:"Email address:"}),Object(f.jsx)("input",{placeholder:"youremail@test.com",name:"email",type:"email",id:"email",onChange:b})]}),Object(f.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(f.jsx)("label",{htmlFor:"pwd",children:"Password:"}),Object(f.jsx)("input",{placeholder:"******",name:"password",type:"password",id:"pwd",onChange:b})]}),d?Object(f.jsx)("div",{children:Object(f.jsx)("p",{className:"error-text",children:"The provided credentials are incorrect"})}):null,Object(f.jsx)("div",{className:"flex-row flex-end",children:Object(f.jsx)("button",{type:"submit",children:"Submit"})})]})]})};var Tt=function(t){var e=Object(n.useState)({email:"",password:""}),c=Object(p.a)(e,2),a=c[0],r=c[1],s=Object(kt.a)(Et),j=Object(p.a)(s,1)[0],l=function(){var t=Object(rt.a)(Object(at.a)().mark((function t(e){var c,n;return Object(at.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,j({variables:{username:a.username,email:a.email,password:a.password,firstName:a.firstName}});case 3:c=t.sent,n=c.data.addUser.token,bt.login(n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(t){var e=t.target,c=e.name,n=e.value;r(Object(i.a)(Object(i.a)({},a),{},Object(h.a)({},c,n)))};return Object(f.jsxs)("div",{className:"container my-1",children:[Object(f.jsx)(o.b,{to:"/login",children:"\u2190 Go to Login"}),Object(f.jsx)("h2",{children:"Signup"}),Object(f.jsxs)("form",{onSubmit:l,children:[Object(f.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(f.jsx)("label",{htmlFor:"username",children:"Username:"}),Object(f.jsx)("input",{placeholder:"Username",name:"username",type:"username",id:"username",onChange:d})]}),Object(f.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(f.jsx)("label",{htmlFor:"firstName",children:"First Name:"}),Object(f.jsx)("input",{placeholder:"Last",name:"firstName",type:"firstName",id:"firstName",onChange:d})]}),Object(f.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(f.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(f.jsx)("input",{placeholder:"youremail@test.com",name:"email",type:"email",id:"email",onChange:d})]}),Object(f.jsxs)("div",{className:"flex-row space-between my-2",children:[Object(f.jsx)("label",{htmlFor:"pwd",children:"Password:"}),Object(f.jsx)("input",{placeholder:"******",name:"password",type:"password",id:"pwd",onChange:d})]}),Object(f.jsx)("div",{className:"flex-row flex-end",children:Object(f.jsx)("button",{type:"submit",children:"Submit"})})]})]})};var $t=function(){return Object(f.jsxs)("header",{className:"flex-row px-1",children:[Object(f.jsx)("h1",{children:Object(f.jsxs)(o.b,{to:"/",children:[Object(f.jsx)("span",{role:"img","aria-label":"shopping bag",children:"\ud83d\udecd\ufe0f"}),"MERN Spa"]})}),Object(f.jsx)("nav",{children:bt.loggedIn()?Object(f.jsxs)("ul",{className:"flex-row",children:[Object(f.jsx)("li",{className:"mx-1",children:Object(f.jsx)(o.b,{to:"/productList",children:"Shop"})}),Object(f.jsx)("li",{className:"mx-1",children:Object(f.jsx)(o.b,{to:"/serviceList",children:"Services"})}),Object(f.jsx)("li",{className:"mx-1",children:Object(f.jsx)(o.b,{to:"/orderHistory",children:"Order History"})}),Object(f.jsx)("li",{className:"mx-1",children:Object(f.jsx)("a",{href:"/",onClick:function(){return bt.logout()},children:"Logout"})})]}):Object(f.jsxs)("ul",{className:"flex-row",children:[Object(f.jsx)("li",{className:"mx-1",children:Object(f.jsx)(o.b,{to:"/products",children:"Shop"})}),Object(f.jsx)("li",{className:"mx-1",children:Object(f.jsx)(o.b,{to:"/services",children:"Services"})}),Object(f.jsx)("li",{className:"mx-1",children:Object(f.jsx)(o.b,{to:"/signup",children:"Signup"})}),Object(f.jsx)("li",{className:"mx-1",children:Object(f.jsx)(o.b,{to:"/login",children:"Login"})})]})})]})};var It=function(){var t=Object(kt.a)(Ct),e=Object(p.a)(t,1)[0];return Object(n.useEffect)((function(){function t(){return(t=Object(rt.a)(Object(at.a)().mark((function t(){var c,n,a,r,s,i,o;return Object(at.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x("cart","get");case 2:if(c=t.sent,n=c.map((function(t){return t._id})),a=c.map((function(t){return t._id})),!n.length){t.next=12;break}return t.next=8,e({variables:{products:n}});case 8:r=t.sent,s=r.data,s.addOrder.products.forEach((function(t){x("cart","delete",t)}));case 12:if(!a.length){t.next=19;break}return t.next=15,e({variables:{services:a}});case 15:i=t.sent,o=i.data,o.addOrder.cervices.forEach((function(t){x("cart","delete",t)}));case 19:setTimeout((function(){window.location.assign("/")}),3e3);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]),Object(f.jsx)("div",{children:Object(f.jsxs)(g,{children:[Object(f.jsx)("h1",{children:"Success!"}),Object(f.jsx)("h2",{children:"Thank you for your purchase!"}),Object(f.jsx)("h2",{children:"You will now be redirected to the home page"})]})})};var At=function(){var t,e=Object(z.b)(et).data;return e&&(t=e.user),Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("div",{className:"container my-1",children:[Object(f.jsx)(o.b,{to:"/",children:"\u2190 Back to Products"}),t?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("h2",{children:["Order History for ",t.username]}),t.orders.map((function(t){return Object(f.jsxs)("div",{className:"my-2",children:[Object(f.jsx)("h3",{children:new Date(parseInt(t.purchaseDate)).toLocaleDateString()}),Object(f.jsxs)("div",{className:"flex-row",children:[t.products.map((function(t,e){var c=t._id,n=t.image,a=t.name,r=t.price;return Object(f.jsxs)("div",{className:"card px-1 py-1",children:[Object(f.jsxs)(o.b,{to:"/products/".concat(c),children:[Object(f.jsx)("img",{alt:a,src:"/images/".concat(n)}),Object(f.jsx)("p",{children:a})]}),Object(f.jsx)("div",{children:Object(f.jsxs)("span",{children:["$",r]})})]},e)})),t.services.map((function(t,e){var c=t._id,n=t.image,a=t.name,r=t.price;return Object(f.jsxs)("div",{className:"card px-1 py-1",children:[Object(f.jsxs)(o.b,{to:"/services/".concat(c),children:[Object(f.jsx)("img",{alt:a,src:"/images/".concat(n)}),Object(f.jsx)("p",{children:a})]}),Object(f.jsx)("div",{children:Object(f.jsxs)("span",{children:["$",r]})})]},e)}))]})]},t._id)}))]}):null]})})},Dt=Object(l.a)({uri:"/graphql"}),Pt=Object(O.a)((function(t,e){var c=e.headers,n=localStorage.getItem("id_token");return{headers:Object(i.a)(Object(i.a)({},c),{},{authorization:n?"Bearer ".concat(n):""})}})),Rt=new d.a({link:Pt.concat(Dt),cache:new u.a});var qt=function(){return Object(f.jsx)(b.a,{client:Rt,children:Object(f.jsx)(o.a,{children:Object(f.jsx)("div",{children:Object(f.jsxs)(F,{children:[Object(f.jsx)($t,{}),Object(f.jsxs)(j.c,{children:[Object(f.jsx)(j.a,{path:"/",element:Object(f.jsx)(y,{})}),Object(f.jsx)(j.a,{path:"/login",element:Object(f.jsx)(Qt,{})}),Object(f.jsx)(j.a,{path:"/signup",element:Object(f.jsx)(Tt,{})}),Object(f.jsx)(j.a,{path:"/success",element:Object(f.jsx)(It,{})}),Object(f.jsx)(j.a,{path:"/orderHistory",element:Object(f.jsx)(At,{})}),Object(f.jsx)(j.a,{path:"/products",element:Object(f.jsx)(pt,{})}),Object(f.jsx)(j.a,{path:"/products/:id",element:Object(f.jsx)(mt,{})}),Object(f.jsx)(j.a,{path:"/services",element:Object(f.jsx)(vt,{})}),Object(f.jsx)(j.a,{path:"/services/:id",element:Object(f.jsx)(_t,{})}),Object(f.jsx)(j.a,{path:"*",element:Object(f.jsx)(Nt,{})})]})]})})})})},Ft=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ut(t,e){navigator.serviceWorker.register(t).then((function(t){t.onupdatefound=function(){var c=t.installing;null!=c&&(c.onstatechange=function(){"installed"===c.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e&&e.onUpdate&&e.onUpdate(t)):(console.log("Content is cached for offline use."),e&&e.onSuccess&&e.onSuccess(t)))})}})).catch((function(t){console.error("Error during service worker registration:",t)}))}s.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(qt,{})}),document.getElementById("root")),function(t){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");Ft?(!function(t,e){fetch(t,{headers:{"Service-Worker":"script"}}).then((function(c){var n=c.headers.get("content-type");404===c.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(t){t.unregister().then((function(){window.location.reload()}))})):Ut(t,e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Ut(e,t)}))}}()}},[[85,1,2]]]);
//# sourceMappingURL=main.e19345e5.chunk.js.map